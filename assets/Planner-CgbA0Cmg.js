import{h as J,u as R,i as o,j as V,k as _,l as I,m as g,q as G,r as a,o as h,s as $,w as n,a as s,c as H,d as K,F as Q,n as X,b as q,t as Y,v as Z,x as ee,y as te,_ as oe}from"./index-CklsWiTl.js";const ae={style:{"text-align":"center",margin:"0",padding:"0px","background-color":"var(--color-light)"}},f="http://1.94.170.22:5000",ne=J({__name:"Planner",props:{currentChat:Object},setup(z){const r=R(),L=o(r.state.userId);o(!1),o(""),o([]),o([]),o("1"),o(!1);const S=o("1");o(0),o(0);let p=null;const E=o("60%"),l=o([]),v=o(null),b=o(null);V(()=>r.state.userId),_(()=>r.getters.getUserId,(e,t)=>{console.log(`User ID changed from ${t} to ${e}`),console.log(e),d(e)});const u=z,m=o([]);I(()=>{x(),p=window.addEventListener("resize",x),d(r.state.userId)});async function F(){try{const e=await g.post(`${f}/create_chat`,{user_id:r.state.userId,history:"{}",agentMemory:"{}"}),t={uid:e.data.chat_uid,history:"{}",agentMemory:"{}"};l.value.push(t),y(t.uid);const i=e.data.chat_uid;console.log("新建聊天的 UID:",i),d(r.state.userId)}catch(e){console.error("创建聊天会话失败:",e)}}const d=async e=>{try{const t=await g.get(`${f}/get_all_chats?user_id=${e}`);l.value=t.data}catch(t){console.error("Error fetching chats:",t)}},y=e=>{const t=l.value.find(i=>i.uid===e);v.value=e,b.value=t,d(r.state.userId),console.log("切换到聊天:",t.history)},N=async e=>{try{const t=await g.post(`${f}/delete_chat`,{chat_id:e});l.value=l.value.filter(i=>i.uid!==e),d(r.state.userId)}catch(t){console.error("Delete chat failed:",t)}};G(()=>{p&&window.removeEventListener("resize",p)});const x=()=>{const e=document.documentElement.clientWidth;E.value=e<=768?"100%":"60%"};function C(){if(u.currentChat&&u.currentChat.history)try{m.value=JSON.parse(u.currentChat.history).messages,console.log("更新:"+m.value[0].from)}catch(e){console.error("Error parsing currentChat.history:",e),m.value=[]}}return I(C),_(()=>u.currentChat,(e,t)=>{e.history!==t.history&&(C(),console.log("再更新:"+m.value))}),o({title:"标题",cover:"封面base64编码",images:["图片A base64","图片B base64"],text:"滚滚长江东逝水滚滚长江东逝水滚滚长江东逝水滚滚长江东逝水，滚滚长江东逝水。滚滚长江东逝水滚滚长江东逝水。",routes:[{name:"路线1",navigation:[{起点:{name:"市中心广场",address:"市中心大道1号",location:{latitude:39.905489,longitude:116.401245}},终点:{name:"历史博物馆",address:"文化路88号",location:{latitude:39.906489,longitude:116.402245}},交通方式:"走路",路程:"2公里",价格:"免费"},{起点:{name:"历史博物馆",address:"文化路88号",location:{latitude:39.906489,longitude:116.402245}},终点:{name:"科技馆",address:"科技路100号",location:{latitude:39.907489,longitude:116.403245}},交通方式:"公交车",路程:"3.5公里",价格:"2元"},{起点:{name:"科技馆",address:"科技路100号",location:{latitude:39.907489,longitude:116.403245}},终点:{name:"购物中心",address:"商业大街200号",location:{latitude:39.908489,longitude:116.404245}},交通方式:"打车",路程:"5公里",价格:"20元"},{起点:{name:"购物中心",address:"商业大街200号",location:{latitude:39.908489,longitude:116.404245}},终点:{name:"公园",address:"自然路50号",location:{latitude:39.909489,longitude:116.405245}},交通方式:"骑车",路程:"1.5公里",价格:"5元"}],events:[{name:"市中心广场",position:"导航数据",description:"市中心广场是个好地方",images:["图片111 base64","图片112 base64"]},{name:"历史博物馆",position:"导航数据",description:"描述烫烫烫烫烫烫烫烫烫锟斤拷fcdafeasfqasaqfasfafasfqfqwfqwfwqqwqwaszxcs",images:["图片121 base64","图片122 base64"]},{name:"科技馆",position:"导航数据",description:"科技馆是个好地方",images:["图片111 base64","图片112 base64"]},{name:"购物中心",position:"导航数据",description:"购物中心是个好地方呀是个好地方",images:["图片111 base64","图片112 base64"]},{name:"公园",position:"导航数据",description:"公园也是好地方呀也是好地方",images:["图片111 base64","图片112 base64"]}]},{name:"路线2",navigation:[{起点:{name:"火焰山",address:"灵台方寸山",location:{latitude:11.118,longitude:2.22226}},终点:{name:"渣滓洞",address:"斜月三星洞",location:{latitude:22.899,longitude:33.878}},交通方式:"筋斗云",路程:"十万八千里",价格:"统统不要钱"}],events:[{name:"途径点1",position:"导航数据",description:"描述",images:["图片211 base64","图片212 base64"]},{name:"途径点2",position:"导航数据",description:"描述",images:["图片221 base64","图片222 base64"]}]}]}),_(S,e=>{console.log(`Active Name changed to: ${e}`)}),o(null),(e,t)=>{const i=a("el-button"),U=a("MoreFilled"),w=a("el-icon"),B=a("el-popover"),M=a("el-menu-item"),P=a("el-menu"),k=a("el-main"),A=a("CirclePlusFilled"),D=a("el-footer"),W=a("el-aside"),j=a("router-view"),O=a("el-container");return h(),$(O,null,{default:n(()=>[s(W,null,{default:n(()=>[s(k,{style:{height:"90%",padding:"0px"}},{default:n(()=>[s(P,{"default-active":e.$route.path,class:"el-menu-demo chat",mode:"vertical","background-color":"var(--bg-color)","text-color":"var(--display-text-color)","active-text-color":"var(--display-text-color-active)",router:""},{default:n(()=>[(h(!0),H(Q,null,K(l.value,c=>(h(),$(M,{index:"/chat/"+c.uid,key:c.uid,class:X(["chat-list-item",{active:v.value===c.uid}]),onClick:T=>y(c.uid),style:{"background-color":"var(--bg-color)"},router:""},{default:n(()=>[q("h1",null,Y(c.uid),1),s(B,{ref_for:!0,ref:"popover",width:100,placement:"right",trigger:"hover","popper-style":"padding: 0px;border:1px solid var(--color-light);"},{reference:n(()=>[s(w,{style:{"margin-right":"2px"}},{default:n(()=>[s(U)]),_:1})]),default:n(()=>[q("div",ae,[s(i,{onClick:T=>N(c.uid),style:{"background-color":"transparent",border:"none",color:"#fff"},type:"danger",size:"small",icon:Z(ee),plain:""},{default:n(()=>[te("删除")]),_:2},1032,["onClick","icon"])])]),_:2},1536)]),_:2},1032,["index","class","onClick"]))),128))]),_:1},8,["default-active"])]),_:1}),s(D,{style:{height:"10%","text-align":"center"}},{default:n(()=>[s(w,{style:{"font-size":"5.5vh","margin-top":"-30%","z-index":"1000",color:"rgb(255,194,151)","box-shadow":"0 0 10px rgba(0, 0, 0, 0.5)","border-radius":"50%","background-image":"radial-gradient(circle at 50% 50%, #fff, #fad0c4)"},onClick:F,class:"add-button"},{default:n(()=>[s(A)]),_:1})]),_:1})]),_:1}),s(k,{class:"planner"},{default:n(()=>[s(j,{currentChat:b.value,userId:L.value},null,8,["currentChat","userId"])]),_:1})]),_:1})}}}),re=oe(ne,[["__scopeId","data-v-453987fd"]]);export{re as default};
