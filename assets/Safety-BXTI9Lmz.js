import{h as B,i as u,u as O,j as T,k as $,r as d,o as P,c as j,a as e,w as a,y as b,m as I,E as p,p as D,f as R,b as o,_ as q}from"./index-CklsWiTl.js";const n=_=>(D("data-v-4fb44075"),_=_(),R(),_),z={class:"common-layout"},A=n(()=>o("span",null,"账号安全",-1)),F=n(()=>o("div",{class:"tag"}," Email ",-1)),G=n(()=>o("br",null,null,-1)),H=n(()=>o("div",{class:"tag"}," 验证码 ",-1)),J=n(()=>o("br",null,null,-1)),K=n(()=>o("div",{class:"tag"}," 旧密码 ",-1)),L=n(()=>o("br",null,null,-1)),M=n(()=>o("div",{class:"tag"}," 新密码 ",-1)),Q=n(()=>o("br",null,null,-1)),W=B({__name:"Safety",setup(_){const g=u(""),h=u(""),y=u(""),f=u(""),w=u(""),r=u(),k=u({email:h,new_password:f}),v=O(),N=u(v.state.userId);T(()=>v.state.userId),$(()=>v.getters.getUserId,(s,l)=>{console.log(`User ID changed from ${l} to ${s}`)});async function S(){try{const s=await I.get(`http://1.94.170.22:5000/get_user_profile?user_id=${N.value}`);r.value=s.data,w.value=r.value.password}catch(s){console.error("There was an error fetching the data!",s)}if(w.value==f.value){p({title:"Oh No",type:"error",message:"新设密码与旧密码重复，不可修改",duration:1500,offset:200});return}else try{const s=await I.post("http://1.94.170.22:5000/reset_password",k.value);r.value=s.data}catch(s){console.error("There was an error sending the post!",s)}r.value.result==0&&r.value.result==0&&p({title:"Oh No",type:"error",message:"未查询到该用户",duration:1500,offset:200}),r.value.result==-1&&p({title:"Oh No",type:"error",message:"邮箱或密码不合法",duration:1500,offset:200}),r.value.result==1&&p({title:"Success",type:"success",message:"密码已修改",duration:1500,offset:200})}function x(){p({title:"Info",type:"info",message:"已发送",duration:1500,offset:200})}return(s,l)=>{const t=d("el-col"),i=d("el-row"),U=d("el-header"),m=d("el-input"),V=d("el-button"),C=d("el-main"),E=d("el-container");return P(),j("div",z,[e(E,null,{default:a(()=>[e(U,{class:"header",style:{width:"100%"}},{default:a(()=>[e(i,null,{default:a(()=>[e(t,{span:1}),e(t,{span:21},{default:a(()=>[A]),_:1}),e(t,{span:2,class:"avatar"})]),_:1})]),_:1}),e(C,{class:"main"},{default:a(()=>[F,e(i,{class:"input-layout"},{default:a(()=>[e(t,{span:2}),e(t,{span:20},{default:a(()=>[e(m,{modelValue:h.value,"onUpdate:modelValue":l[0]||(l[0]=c=>h.value=c),placeholder:"请输入邮箱",class:"email"},null,8,["modelValue"])]),_:1}),e(t,{span:2})]),_:1}),G,H,e(i,{class:"input-layout"},{default:a(()=>[e(t,{span:2}),e(t,{span:14},{default:a(()=>[e(m,{modelValue:g.value,"onUpdate:modelValue":l[1]||(l[1]=c=>g.value=c),placeholder:"请输入验证码",class:"input"},null,8,["modelValue"])]),_:1}),e(t,{span:1}),e(t,{span:5},{default:a(()=>[e(V,{type:"primary",color:"var(--color-light-light)",class:"send-button",onClick:x},{default:a(()=>[b("发送验证码")]),_:1})]),_:1}),e(t,{span:2})]),_:1}),J,K,e(i,{class:"input-layout"},{default:a(()=>[e(t,{span:2}),e(t,{span:20},{default:a(()=>[e(m,{modelValue:y.value,"onUpdate:modelValue":l[2]||(l[2]=c=>y.value=c),placeholder:"请输入旧密码",class:"input"},null,8,["modelValue"])]),_:1}),e(t,{span:2})]),_:1}),L,M,e(i,{class:"input-layout"},{default:a(()=>[e(t,{span:2}),e(t,{span:20},{default:a(()=>[e(m,{modelValue:f.value,"onUpdate:modelValue":l[3]||(l[3]=c=>f.value=c),placeholder:"请输入新密码",class:"input"},null,8,["modelValue"])]),_:1}),e(t,{span:2})]),_:1}),Q,e(i,{class:"row"},{default:a(()=>[e(t,{span:8}),e(t,{span:8},{default:a(()=>[e(V,{type:"primary",color:"var(--color-light-light)",class:"button",onClick:S},{default:a(()=>[b("重置密码")]),_:1})]),_:1}),e(t,{span:8})]),_:1})]),_:1})]),_:1})])}}}),Y=q(W,[["__scopeId","data-v-4fb44075"]]);export{Y as default};
